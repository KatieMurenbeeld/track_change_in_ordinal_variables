---
title: "Wildlife Value Orientations: Using Vectors to Aggregate"
author: "Katie Murenbeeld"
format: 
  revealjs:
    smaller: true
    scrollable: true
---

# The Challenge

## How to weight ordinal data to track through time?

## Wildlife value orientations as vectors?
:::: {.columns}

::: {.column width="60%"}

- For each time step, the WVOs will have a magnitude (the total number of articles with that score) and a direction (the angle in degrees)
- Use vector addition o get a aggregate WVO for the newspaper at that time step
- And then track those "aggregate" vectors through time
:::

::: {.column width="40%"}

```{r vector_image}
#| fig-width: 4
#| fig-height: 6
# Load Required Packages
library(tidyverse) # For loading and manipulating data tables
library(ggplot2) # For plotting and visualization
library(ggrepel) # For ease of plotting labels
library(DT) # For creating nice looking tables
library(patchwork) # For placing plots

# Create sample table for the WVO vectors
## label (mutualism or domination), magnitude (1 for all), deg, x and y positions
sample_df <- data.frame(
  wvo = c("1 Domination", "2", "3", "4 Neutral", "5", "6", "7 Mutualism"),
  mag = c((rep(1, 7))),
  deg = c(270, 300, 330, 360, 30, 60, 90)
)
sample_df <- sample_df %>%
  mutate(y = mag * sin(deg*(pi/180)), 
         x = mag * cos(deg*(pi/180)))

# Create a color palette
#col_pal <- c("seagreen", "darkcyan", "cyan4", "cyan3", "cadetblue", "lightskyblue", "skyblue4")
col_pal <- hcl.colors(7, "Tofino")

# Use a for loop to plot the segments
p <- ggplot(sample_df) +
  geom_segment(x = 0, y = 0, xend = sample_df$x[1], yend = sample_df$y[1],
               arrow = arrow(length=unit(0.15,"cm")), color = col_pal[1],
               linewidth = 2
  )
for (i in 1:nrow(sample_df)){
  p <- p + 
    geom_segment(x = 0, y = 0, xend = sample_df$x[i+1], yend = sample_df$y[i+1],
                 arrow = arrow(length=unit(0.25,"cm")), color = col_pal[i],
                 linewidth = 2
                 ) +
    annotate("text", x = 0, y = -1.1, label = "1: Domination") + 
    annotate("text", x = 0.56, y = -0.91, label = "2") +
    annotate("text", x = 0.91, y = -0.56, label = "3") +
    annotate("text", x = 1.1, y = 0.1, label = "4: Neutral") +
    annotate("text", x = 0.91, y = 0.56, label = "5") +
    annotate("text", x = 0.56, y = 0.91, label = "6") +
    annotate("text", x = 0, y = 1.1, label = "7: Mutualism") +
    geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
    geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
    coord_fixed() +
    xlim(-0.25, 1.25) + 
    ylim(-1.25, 1.25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())
}
print(p)
```
:::

::::

# The Process

## Vectors with magnitude and degree

For each newspaper per year

- Data frame with magnitude, direction, positions of "head" of vector

```{r data table}

# Load in the wvo by paper and year data
df_plot <- read_csv("/Users/katiemurenbeeld/Analysis/VIP_NLP/test_tracking_values/data/processed/test_wvo_vectors_years_2025-08-25.csv")

# rename the columns
names(df_plot) <- c("Publication", "Year", "Predicted_WVO", "Magnitude", "Direction", "y", "x")

# set the numeric columns to round to two decimal places
is_num <- sapply(df_plot, is.numeric)
df_plot[is_num] <- lapply(df_plot[is_num], round, 2)

# use the DT package to output a scrollable/interactive table
DT::datatable(df_plot, options = list(pageLength = 2), editable = list(
  target = 'row', disable = list(columns = c(1, 3, 4))
))

```
- But how to get the x and y positions?

## Vectors with magnitude and degree

Trigonometry

::: {.absolute top=120 left=0 width="600" height="800"}
```{r vector_get_x_y, fig.width = 4, fig.height = 6}

p_curve <- p +
  geom_curve(x = 0, y = 1.0, xend = 1, yend = 0, curvature = -0.5) + 
  annotate("text", x = 1.05, y = -0.1, label = "0") + 
  annotate("text", x = 0.05, y = 1.2, label = "90") + 
  xlim(-0.25, 1.25) + 
  ylim(-1.25, 1.25)
p_curve
```
:::

::: {.absolute top=120 left=400}
- To calculate the x and y coordinates:

$$x = mag * cos(deg*\frac{\pi}{180})$$
$$y = mag * sin(deg*\frac{\pi}{180})$$
For example, the x and y coordinates <br>
for 1 article with a WVO of 6

$$x = 1 * cos(60*\frac{\pi}{180}) = 0.5$$
$$y = 1 * sin(60*\frac{\pi}{180}) = 0.87$$
:::

## Vector Addition - Part 1

```{r vector_addition01}

#| fig-width: 4
#| fig-height: 6

y_new <- df_plot$y[1] + df_plot$y[2] + df_plot$y[3] + df_plot$y[4] + df_plot$y[5]
x_new <- df_plot$x[1] + df_plot$x[2] + df_plot$x[3] + df_plot$x[4] + df_plot$x[5]

ggplot() +
  geom_point() +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[1], yend = df_plot$y[1]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[2], yend = df_plot$y[2]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[3], yend = df_plot$y[3]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[4], yend = df_plot$y[4]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[5], yend = df_plot$y[5]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan",
               linewidth =2
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  #annotate("text", x = , y = , label = "") +
  coord_fixed() +
  #xlim(-0.25, 1.25) + 
  #ylim(-1.25, 1.25) +
  theme_minimal() +
  theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())
```
## Vector Addition - Part 2

- Scores are not independent of previous year
- Tails start at the head of the previous year

```{r vector_addition02rc}


y_new <- df_plot$y[1] + df_plot$y[2] + df_plot$y[3] + df_plot$y[4] + df_plot$y[5]
x_new <- df_plot$x[1] + df_plot$x[2] + df_plot$x[3] + df_plot$x[4] + df_plot$x[5]

plt <- ggplot() +
  geom_point() +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[1], yend = df_plot$y[1]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[2], yend = df_plot$y[2]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[3], yend = df_plot$y[3]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[4], yend = df_plot$y[4]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[5], yend = df_plot$y[5]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan"
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
   # xlim(-0.25, 1.25) + 
    #ylim(-1.25, 1.25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

y_new_2 <- df_plot$y[6] + df_plot$y[7] + df_plot$y[8] + df_plot$y[9] + df_plot$y[10]
x_new_2 <- df_plot$x[6] + df_plot$x[7] + df_plot$x[8] + df_plot$x[9] + df_plot$x[10]

plt2 <- ggplot() +
  geom_point() +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[6], yend = df_plot$y[6]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[7], yend = df_plot$y[7]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[8], yend = df_plot$y[8]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[9], yend = df_plot$y[9]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[10], yend = df_plot$y[10]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new_2, yend = y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
   # xlim(-0.25, 1.25) + 
  #  ylim(-1.25, 1.25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

plt3 <- ggplot() +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan"
  ) +
  geom_segment(aes(x = x_new, y = y_new, xend = x_new + x_new_2, yend = y_new + y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
               ) +
   coord_fixed() +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
   # xlim(-0.25, 1.25) + 
  #  ylim(-1.25, 1.25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

plt | plt2 | plt3
```
## Vector Addition - Part 3

- Scores are independent from previous year 
- Tails all start at 0, but heads are adjusted

```{r vector_addition03}


y_new <- df_plot$y[1] + df_plot$y[2] + df_plot$y[3] + df_plot$y[4] + df_plot$y[5]
x_new <- df_plot$x[1] + df_plot$x[2] + df_plot$x[3] + df_plot$x[4] + df_plot$x[5]

plt <- ggplot() +
  geom_point() +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[1], yend = df_plot$y[1]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[2], yend = df_plot$y[2]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[3], yend = df_plot$y[3]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[4], yend = df_plot$y[4]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[5], yend = df_plot$y[5]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan"
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
    xlim(-0.25, 15) + 
    ylim(-15, 15) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

y_new_2 <- df_plot$y[6] + df_plot$y[7] + df_plot$y[8] + df_plot$y[9] + df_plot$y[10]
x_new_2 <- df_plot$x[6] + df_plot$x[7] + df_plot$x[8] + df_plot$x[9] + df_plot$x[10]

plt2 <- ggplot() +
  geom_point() +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[6], yend = df_plot$y[6]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[7], yend = df_plot$y[7]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[8], yend = df_plot$y[8]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[9], yend = df_plot$y[9]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = df_plot$x[10], yend = df_plot$y[10]),
               arrow = arrow(length=unit(0.15,"cm"))
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new_2, yend = y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
    xlim(-0.25, 15) + 
    ylim(-15, 15) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

plt3 <- ggplot() +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan"
  ) +
  geom_segment(aes(x = x_new, y = 0, xend = x_new + x_new_2, yend = y_new + y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
  ) +
  geom_point(aes(x = x_new, y = y_new), color = "darkcyan") +
  geom_point(aes(x = x_new + x_new_2, y = y_new + y_new_2), color = "purple4") +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
   coord_fixed() +
    xlim(-0.25, 25) + 
    ylim(-25, 25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

plt4 <- ggplot() +
  geom_segment(aes(x = 0, y = 0, xend = x_new, yend = y_new),
               arrow = arrow(length=unit(0.15,"cm")), color = "darkcyan"
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new_2, yend = y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
  ) +
  geom_segment(aes(x = 0, y = 0, xend = x_new_2, yend = y_new_2),
               arrow = arrow(length=unit(0.15,"cm")), color = "purple4"
  ) +
  geom_point(aes(x = x_new, y = y_new), color = "darkcyan") +
  geom_point(aes(x = x_new_2, y = y_new_2), color = "purple4") +
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
   coord_fixed() +
    xlim(-0.25, 25) + 
    ylim(-25, 25) +
    theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank())

plt | plt2 | plt3 | plt4
```

# Examples

## Great Falls Tribune

``` {r gft}


df_gft <- read_csv("/Users/katiemurenbeeld/Analysis/VIP_NLP/test_tracking_values/data/processed/test_wvo_vectors_gft_years_2025-08-26.csv")

ggplot(df_gft, aes(head_x, head_y, color = as.factor(year))) + 
  geom_line(color = "black") +
  geom_point() +
  xlim(-0.5, 550) + 
  ylim(-20, 20) + 
  theme_minimal() + 
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
  labs(title="Great Falls Tribune") +
  theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank(),
        legend.position = "None")

```

## New York Times

``` {r nyt}
df_nyt <- read_csv("/Users/katiemurenbeeld/Analysis/VIP_NLP/test_tracking_values/data/processed/test_wvo_vectors_nyt_years_2025-08-26.csv")

ggplot(df_nyt, aes(head_x, head_y, color = as.factor(year))) + 
  geom_line(color = "black") +
  geom_point() +
  xlim(-0.5, 200) + 
  ylim(-10, 10) + 
  theme_minimal() + 
  geom_hline(yintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  geom_vline(xintercept = 0, color = "grey", linewidth = 0.5, linetype = "dashed") +
  coord_fixed() +
  theme_minimal() +
    theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(), 
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        panel.grid = element_blank(),
        legend.position = "None")
  labs(title="New York Times")
```

## What else could we do

- Would box plots or violin plots show the same thing?
- What if we did the angle from 0 for each vector sum?
- could do the point size as the number of articles
- the colors of the points as +- valence
- for the Montana papers would want to change the time step to a finer step to get a better idea of seasonality where bear occur
- where should the starting point be? Look at Jan articles? We arbitrarily break December from January
- the question of independence
- could do a rolling average (vector sums)
- the sum of changes from month to month - in some years the values might be changing more in some months than others - a way to weight the month
- sum of the angles to get an idea of the polarity (equiv to std or variance)
- the vector sum is the equiv to means
- a value shift could look like a view different things - the shift like Manfredo (things are pointing in different directions) or values have become more binary or more consolidated? (echo chamber is growing)
- finer time scale would be better for coordinating to events (Jaric paper - attention transience)
- next step, prototype the angle version and the moving window

## For the classification

- get the model to recognize ordinal data not class data - look into random forest, can it handle ordinal data? could neural networks?
- the codes/scores are an abstraction







